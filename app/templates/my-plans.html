{% extends "base.html" %}
{% block title %}Mis Planes Comprados{% endblock %}

{% block content %}

<div style="display: flex; justify-content: space-between; align-items: center;">
    <h1>Mis Planes Comprados</h1>
    <a href="/plans/" role="button" class="secondary">Ver más planes</a>
</div>
<a href="/dashboard">⬅ Volver al Dashboard</a>
<hr>

{% if plans %}
    {% for plan in plans %}
        <article>
            <header>
                <h2>{{ plan.title }}</h2>
            </header>
            
            <p>{{ plan.description or 'Sin descripción.' }}</p>

            {% if plan.routines %}
                {% for routine in plan.routines %}
                    <h3 style="border-bottom: 1px solid #ccc; padding-bottom: 5px;">
                        Rutina: {{ routine.name }}
                    </h3>
                    
                    <ul>
                    {% for session in routine.sessions %}
                        <li>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em;">
                                <div>
                                    <strong>{{ session.session_name }}</strong>
                                    <ul style="font-size: 0.9em; margin: 0; padding-left: 20px;">
                                        {% for ex in session.exercises %}
                                            <li><small>{{ ex.exercise_name }} ({{ ex.target_sets }}x{{ ex.target_reps }})</small></li>
                                        {% else %}
                                            <li><small><em>(Sin ejercicios)</em></small></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                <a href="/track/session/{{ session.id }}" role="button" 
                                   style="white-space: nowrap; margin-left: 1em;">
                                    ▶ Empezar
                                </a>
                            </div>
                        </li>
                    {% else %}
                        <li><p><em>Esta rutina no tiene sesiones asignadas.</em></p></li>
                    {% endfor %}
                    </ul>
                {% endfor %}
            {% else %}
                <p><em>Este plan aún no tiene rutinas asociadas.</em></p>
            {% endif %}
            
        </article>
    {% endfor %}
{% else %}
    <p>Aún no has comprado ningún plan.</p>
{% endif %}

{% endblock %}